# version format
version: '{build}'

environment:
  VisualStudioVersion: 14.0
  fast_finish: true
  matrix:
#  - ARCH: "i686"
  - ARCH: "x86_64"

os: Visual Studio 2015

configuration: Release
    
# Configure git linebreaks
init:
  - git config --global core.autocrlf input
  - ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

cache:
  - c:\projects\gsl -> appveyor.yml
  - c:\projects\qwt -> appveyor.yml
  
install:
    # Install GSL
  - cd c:\projects
  - git clone --depth=1 https://github.com/ampl/gsl.git gsl
  - pushd gsl && cmake . & popd
    # Install Qwt
  - svn export svn://svn.code.sf.net/p/qwt/code/branches/qwt-6.1 qwt

deploy:
    description: 'Release description'
    provider: GitHub
    auth_token:
        secure: e/Uc+Q6xQyd6u9tBsvh6UlYfmmJgSL/cmoq6dhS5NHkgQAvETilqfDsO2euzazfp
    draft: true
    prerelease: false
    on:
        # branch: /v\d+\.\d+\.\d+/       # Match against the version tag
        branch: master
        appveyor_repo_tag: true        # deploy on tag push only

on_finish:
  - ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
